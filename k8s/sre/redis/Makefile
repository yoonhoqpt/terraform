RELEASE_NAME=redis
CHART_NAME=bitnami/redis
VERSION=18.12.0
NAMESPACE?=backend

.PHONY: install-dependencies
install-dependencies:
	helm repo add bitnami https://charts.bitnami.com/bitnami
	helm repo update

.PHONY: deploy
deploy: install-dependencies
	helm upgrade --install --wait \
        --namespace $(NAMESPACE) \
        $(RELEASE_NAME) $(CHART_NAME) \
        --set architecture=standalone \
        --set tls.enabled=true \
        --set tls.autoGenerated=true \
        --set tls.authClients=false \
        --set metrics.enabled=true \
        --version $(VERSION)

.PHONY: delete
delete: install-dependencies
	helm uninstall -n $(NAMESPACE) $(RELEASE_NAME)